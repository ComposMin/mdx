(alias
 ((name runtest)
  (deps (section.md section.md.expected (package mdx)))
  (action (progn
           (run mdx test -s Testing ${<})
           (diff? ${<}.expected ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (pp.md section.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (mlt.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (semisemi.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (exit.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (padding.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (multilines.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (lines.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (lwt.md (package mdx)))
  (action (progn
           (run mdx test ${<})
           (diff? ${<} ${<}.corrected)))))

(rule
 ((targets (section.ml))
  (deps    (section.md (package mdx)))
  (action  (with-stdout-to ${@} (run mdx pp ${<})))))

(executable ((name section)))

(alias
 ((name runtest)
  (deps (section.exe))
  (action (run ${<}))))
