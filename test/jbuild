(alias
 ((name runtest)
  (deps (section.md section.md.expected))
  (action (progn
           (run ${exe:../bin/main.exe} test -s Testing ${<})
           (diff? ${<}.expected ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (pp.md section.md))
  (action (progn
           (setenv MDX ${exe:../bin/main.exe}
            (run ${exe:../bin/main.exe} test ${<}))
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (mlt.md))
  (action (progn
           (setenv MDX ${exe:../bin/main.exe}
            (run ${exe:../bin/main.exe} test ${<}))
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (semisemi.md))
  (action (progn
           (setenv MDX ${exe:../bin/main.exe}
            (run ${exe:../bin/main.exe} test ${<}))
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (exit.md))
  (action (progn
           (setenv MDX ${exe:../bin/main.exe}
            (run ${exe:../bin/main.exe} test ${<}))
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (padding.md))
  (action (progn
           (setenv MDX ${exe:../bin/main.exe}
            (run ${exe:../bin/main.exe} test ${<}))
           (diff? ${<} ${<}.corrected)))))

(alias
 ((name runtest)
  (deps (multilines.md))
  (action (progn
           (run ${exe:../bin/main.exe} test ${<})
           (diff? ${<} ${<}.corrected)))))

(rule
 ((targets (section.ml))
  (deps    (section.md))
  (action  (with-stdout-to ${@} (run ${exe:../bin/main.exe} pp ${<})))))

(executable ((name section)))

(alias
 ((name runtest)
  (deps (section.exe))
  (action (run ${<}))))
